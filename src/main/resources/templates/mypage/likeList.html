<!DOCTYPE html>
<html lang="en" class="light-style layout-navbar-fixed layout-wide "
      data-theme="theme-default" data-assets-path="/assets/"
      data-template="front-pages"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/common/common.html}">
<!--Page CSS -->
<th:block layout:fragment="topScript">
    <link rel="stylesheet" href="/assets/vendor/css/pages/wizard-ex-checkout.css" />
    <script src="/assets/vendor/js/template-customizer.js"></script>

</th:block>


<th:block layout:fragment="content">
    <!-- Sections:Start -->

    <section class="section-py bg-body">
        <div class="container">
            <form id="wizard-checkout-form" class="card p-5" onSubmit="return false">
                <!-- Cart -->
                <div id="checkout-cart" class="content">
                    <div class="row">
                        <!-- Cart left -->
                        <div class="col-xl-12 mb-3 mb-xl-0">
                            <!-- Shopping bag -->
                            <h5><strong class="text-primary" th:text="${totalCnt}"></strong> Í∞úÏùò Í∞ïÏùò</h5>
                            <div class="d-flex align-items-center m-0">
                                <div class="form-check form-check-primary col-6">
                                    <input class="form-check-input" type="checkbox" id="checkAll" />
                                    <label class="form-check-label" for="checkAll">&nbsp; Ï†ÑÏ≤¥ ÏÑ†ÌÉù</label>
                                </div>
                                <div class="col-6 row justify-content-end">
                                    <button type="button" class="btn btn-label-danger col-lg-3 col-sm-12 m-0 my-3" onclick="removeGoods()">ÏÑ†ÌÉù Í∞ïÏùò ÏÇ≠Ï†ú</button>
                                </div>
                            </div>
                            <hr class="mt-1">
                            <ul class="list-group mb-3">
                                <th:block th:if="${goodDTOList != null and goodDTOList.size() > 0}">
                                    <li class="list-group-item p-4" th:each="dto, status : ${goodDTOList}" th:if="${dto.lectureDTO != null}">
                                        <div class="d-flex gap-3">
                                            <div class="form-check form-check-primary d-flex align-items-center">
                                                <label class="form-check-label" for="customCheck"></label>
                                                <input class="form-check-input selectCheck" type="checkbox" id="customCheck" th:data-goodIdx="${dto.goodIdx}" th:value="${dto.lectureIdx}" name="lectureIdx"/>
                                            </div>
                                            <div class="flex-shrink-0 d-flex align-items-center">
                                                <img th:src="${dto.lectureDTO != null and dto.lectureDTO.thumbnailImgFile != null} ? '/upload/'+${dto.lectureDTO.thumbnailImgFile} : '/assets/img/default.png'" alt="Í∞ïÏùò Ïç∏ÎÑ§Ïùº" class="w-px-100">
                                            </div>
                                            <div class="flex-grow-1">
                                                <div class="row align-items-center">
                                                    <div class="col-md-8">
                                                        <p class="me-3 mb-0"><a th:href="'/lecture/view?lectureIdx='+${dto.lectureIdx}" class="text-body" th:text="${dto.lectureDTO.title}">Í∞ïÏùò Î™Ö</a></p>
                                                        <div class="text-muted mb-2 d-flex flex-wrap"><span class="me-1"><a th:href="'/lecture/view?lectureIdx='+${dto.lectureIdx}" th:text="${dto.lectureDTO.teacherName}">ÎàÑÍµ¨ÎàÑÍµ¨</a></span> ÏÑ†ÏÉùÎãò</div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="text-md-end">
                                                            <button type="button" class="btn-close btn-pinned" aria-label="Close" th:data-goodIdx="${dto.goodIdx}" onclick="removeGood(this)"></button>
                                                            <div class="my-2 my-md-4 mb-md-5"><span class="text-primary" th:text="${dto.lectureDTO.price}">39,900</span> Ïõê</div>
                                                            <!--                          <button type="button" class="btn btn-sm btn-label-primary mt-md-3">Ï∞úÌïòÍ∏∞</button>-->
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </th:block>
                                <th:block th:unless="${goodDTOList != null and goodDTOList.size() > 0}">
                                    <li class="list-group-item p-4">
                                        <p>Ï∞ú ÎÇ¥Ïó≠Ïù¥ ÏóÜÏäµÎãàÎã§.</p>
                                    </li>
                                </th:block>
                            </ul>
                            <!-- Wishlist -->
                            <div class="list-group">
                                <a href="/lecture/list" class="list-group-item d-flex justify-content-between">
                                    <span>Îçî ÎßéÏùÄ Í∞ïÏùò Ï∞úÔ∏èü©∑ ÌïòÎü¨ Í∞ÄÍ∏∞Ô∏è</span>
                                    <i class="bx bx-sm bx-chevron-right scaleX-n1-rtl"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </section>

</th:block>


<th:block layout:fragment="script">
    <script src="/assets/vendor/libs/popper/popper.js"></script>

    <!-- Vendors JS -->
    <script src="/assets/vendor/libs/jquery/jquery.js"></script>
    <script>
        //Ï†ÑÏ≤¥ ÏÑ†ÌÉù
        const checkAll = document.getElementById('checkAll');
        checkAll.addEventListener('change', () => {
            let checkYN = checkAll.checked;
            let selectChecks = document.querySelectorAll('.selectCheck');
            if (checkYN) {
                for (let select of selectChecks) {
                    select.checked = true;
                }
            } else {
                for (let select of selectChecks) {
                    select.checked = false;
                }
            }
        })
        function removeGood(element) {
            removePOST(element.dataset.goodidx);
        }

        function removeGoods() {
            let idxes = document.querySelectorAll('.selectCheck:checked');
            if(idxes.length > 0) {
                let idxesArr = [];
                for(let idx of idxes) {
                    idxesArr.push(idx.dataset.goodidx);
                }
                removePOST(idxesArr);
            } else {
                alert("ÏÑ†ÌÉùÎêú Í∞ïÏùòÍ∞Ä ÏóÜÏäµÎãàÎã§.")
            }
        }

        function removePOST(strOrArr) {
            let formEl = document.createElement('form');
            formEl.action = '/mypage/deleteGood';
            formEl.method = 'post';
            let inputEl;
            if(typeof strOrArr.valueOf() == "string") {
                inputEl = document.createElement('input');
                inputEl.type = 'hidden';
                inputEl.name = 'goodIdx';
                inputEl.value = strOrArr;
                formEl.append(inputEl);
            } else {
                for(let str of strOrArr) {
                    inputEl = document.createElement('input');
                    inputEl.type = 'hidden';
                    inputEl.name = 'goodIdx';
                    inputEl.value = str;
                    formEl.append(inputEl);
                }
            }
            document.body.append(formEl);
            formEl.submit();
        }
    </script>
</th:block>


</html>

<!-- beautify ignore:end -->

